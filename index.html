<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Pasiecznik ULTRA PRO</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#A9711C">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Miodowo-leśny (B1) */
      --primary:#D9A441;          /* miód jasny */
      --primary-dark:#A9711C;     /* bursztyn */

      --bg:#F4F1EC;               /* ciepły beż tła */
      --white:#FFFDF8;            /* ciepła biel kart */
      --text:#1F2A24;             /* ciemna zieleń-czerń */

      --danger:#9C3A2B;           /* naturalna czerwień */
      --success:#2F5D50;          /* zieleń lasu */
      --blue:#6B7F3E;             /* oliwka (akcje pomocnicze) */

      --slate:#7A5C3E;            /* drewno */
      --purple:#2F5D50;           /* leśny akcent (zamiast fioletu) */
      --emerald:#2F5D50;          /* leśny */
      --orange:#E3B23C;           /* zgaszony żółty */

      --border:#E6DCCF;           /* ciepły obrys */
    }
    
    /* STYL CZCIONKI: Inter + System Native */
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        background-color:var(--bg);
        /* Tło: proste heksagony, jeden rozmiar, bez nakładania */
        background-image: url("data:image/svg+xml,%3Csvg width='56' height='100' viewBox='0 0 56 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M28 66L0 50L0 16L28 0L56 16L56 50L28 66L28 100' fill='none' stroke='%23D9A441' stroke-width='1' opacity='0.15'/%3E%3Cpath d='M28 0L28 34L0 50L0 84L28 100L56 84L56 50L28 34' fill='none' stroke='%23D9A441' stroke-width='1' opacity='0.15'/%3E%3C/svg%3E");
        background-size: 56px 100px; 
        background-attachment:fixed;
        color:var(--text);
        margin:0;
        padding-bottom:90px;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .header{background:var(--primary);color:#fff;padding:12px;position:sticky;top:0;z-index:50;box-shadow:0 4px 6px -1px rgba(0,0,0,.1)}
    .header-top{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px}
    .header-title{font-weight:700;text-transform:uppercase;letter-spacing:0.5px;font-size:1.05rem}
    .nav-scroll{display:flex;gap:8px;overflow-x:auto;padding-bottom:5px;scrollbar-width:none}
    .nav-scroll::-webkit-scrollbar{display:none}
    .container{max-width:1200px;margin:0 auto;padding:16px}
    .grid{display:grid;gap:16px}
    .cols-2{grid-template-columns:repeat(2,1fr)}
    @media (min-width:640px){.grid-hives{grid-template-columns:repeat(3,1fr)}}
    @media (min-width:768px){.grid-hives{grid-template-columns:repeat(4,1fr)}}
    @media (min-width:1024px){.grid-hives{grid-template-columns:repeat(6,1fr)}}
    @media (max-width:639px){.grid-hives{grid-template-columns:repeat(2,1fr)}}
    
    .btn{border:none;padding:8px 16px;border-radius:10px;font-weight:600;cursor:pointer;text-transform:uppercase;font-size:.75rem;transition:.2s;color:#fff;display:inline-flex;align-items:center;justify-content:center;gap:6px;white-space:nowrap; letter-spacing: 0.3px;}
    .btn:active{transform:scale(.96)}
    .btn-nav{background:var(--primary-dark);border:1px solid rgba(255,255,255,.18)}
    .btn-green{background:var(--success)}
    .btn-red{background:var(--danger)}
    .btn-blue{background:var(--blue)}
    .btn-slate{background:var(--slate)}
    .btn-orange{background:var(--orange)}
    .btn-ghost{background:transparent;color:var(--text);border:1px solid var(--border)}
    .btn-ghost:active{transform:scale(.98)}
    .btn-chip{background:#0f172a;color:#fff;border:1px solid rgba(255,255,255,.12);padding:8px 10px}
    .btn-chip.active{background:var(--blue)}
    .btn-chip.active-red{background:var(--danger)}
    .btn-chip.active-slate{background:var(--slate); border-color:#fff;}
    .card{background:var(--white);border-radius:14px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,.1);border:1px solid var(--border)}
    .input{width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:10px;font-size:14px;box-sizing:border-box;background:#fff; font-family: inherit;}
    .input:focus{outline:2px solid var(--primary);border-color:transparent}
    .hidden{display:none!important}
    .flex{display:flex}
    .gap-2{gap:8px}
    .gap-3{gap:12px}
    .justify-between{justify-content:space-between}
    .items-center{align-items:center}
    .w-full{width:100%}
    .text-center{text-align:center}
    .mb-2{margin-bottom:8px}
    .mt-2{margin-top:8px}
    .mt-3{margin-top:12px}
    .hive-card{border-bottom:6px solid var(--primary);cursor:pointer;transition:transform .2s}
    .hive-card:hover{transform:translateY(-2px)}
    .hive-card.archived{opacity:0.7; filter:grayscale(0.8); border-bottom-color:#94a3b8;}
    
    .text-alert{color:var(--danger);font-weight:700;animation:blink 2s infinite}
    @keyframes blink{0%{opacity:1}50%{opacity:.55}100%{opacity:1}}
    details{border:1px solid var(--border);border-radius:12px;margin-bottom:10px;overflow:hidden;background:#fff}
    details>summary{background:#f8fafc;padding:12px;font-weight:700;cursor:pointer;list-style:none;font-size:.8rem;text-transform:uppercase;color:#475569;display:flex;justify-content:space-between;align-items:center; letter-spacing: 0.5px;}
    details[open]>summary{background:#e2e8f0}
    .details-content{padding:12px;border-top:1px solid var(--border);display:grid;gap:10px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;font-weight:600;font-size:11px;border:1px solid var(--border);background:#fff}
    .muted{color:#64748b;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:1px}
    .small{font-size:12px;color:#64748b;font-weight:500}
    .hr{height:1px;background:var(--border);margin:10px 0}
    .row{display:grid;grid-template-columns:1fr;gap:10px}
    @media(min-width:700px){.row.cols2{grid-template-columns:1fr 1fr}}
    @media(min-width:900px){.row.cols3{grid-template-columns:1fr 1fr 1fr}}
    
    /* Input Label helper */
    .lbl { display:block; font-size:11px; font-weight:700; color:#64748b; margin-bottom:4px; text-transform:uppercase;}

    /* Confirm dialog */
    .confirm-overlay{position:fixed;inset:0;background:rgba(15,23,42,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:9999}
    .confirm-overlay.show{display:flex}
    .confirm-box{width:min(520px,100%);background:#fff;border-radius:18px;border:1px solid var(--border);box-shadow:0 12px 40px rgba(0,0,0,.25);overflow:hidden}
    .confirm-head{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:10px}
    .confirm-title{font-weight:700;text-transform:uppercase;letter-spacing:1px;font-size:14px}
    .confirm-body{padding:16px}
    .confirm-foot{padding:12px 16px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px}

    /* Toast */
    .toast{position:fixed;left:50%;bottom:110px;transform:translateX(-50%);background:#0f172a;color:#fff;
      padding:10px 14px;border-radius:14px;font-weight:600;box-shadow:0 10px 30px rgba(0,0,0,.25);
      z-index:10001;max-width:min(560px,92%);text-align:center;display:none}
    .toast.show{display:block}

    /* Voice recording animation */
    .btn-mic-active {
        background-color: var(--danger) !important;
        animation: pulse-red 1.5s infinite;
    }
    @keyframes pulse-red {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
        70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
        100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
    }

    /* MAPA STYLES */
    .map-container {
        width: 100%;
        height: 70vh; /* Wysokość mapy na ekranie */
        border: 2px solid var(--border);
        border-radius: 14px;
        overflow: hidden; /* Ukrywa paski przewijania kontenera zewnętrznego */
        background: #fff;
        position: relative;
    }
    .map-viewport {
        width: 100%;
        height: 100%;
        overflow: auto; /* To pozwala przewijać mapę w środku */
        background-color: #6B7F3E; /* Kolor trawy */
        background-image: 
            radial-gradient(#5a6d33 15%, transparent 16%),
            radial-gradient(#5a6d33 15%, transparent 16%);
        background-size: 20px 20px;
        background-position: 0 0, 10px 10px;
        position: relative;
        /* Ważne dla touch-action w Chrome */
        touch-action: pan-x pan-y; 
    }
    .map-surface {
        width: 1500px; /* Rozmiar wirtualnego ogrodu */
        height: 1500px;
        position: relative;
    }
    
    /* STYL ULA NA MAPIE - WYGLĄD DOMKU */
    .map-hive {
        position: absolute;
        width: 72px;  /* SZERSZY, żeby tekst się mieścił */
        height: 60px;
        background-color: #FFFDF8; /* Kolor drewna/bieli */
        
        /* Ramki tworzące wygląd ula */
        border-left: 2px solid var(--slate);
        border-right: 2px solid var(--slate);
        border-top: 10px solid var(--primary-dark); /* Daszek */
        border-bottom: 6px solid var(--slate);      /* Wylotek */
        border-radius: 4px 4px 2px 2px;
        
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        
        font-weight: 800;
        font-size: 11px; /* Mniejsza czcionka */
        line-height: 1.1;
        color: var(--text);
        
        box-shadow: 0 5px 10px rgba(0,0,0,0.25);
        cursor: grab;
        z-index: 10;
        touch-action: none; /* Kluczowe dla przesuwania elementu */
        user-select: none;
        word-wrap: break-word; /* Zawijanie długich nazw */
        padding: 2px;
    }
    
    .map-hive.dragging {
        opacity: 0.8;
        transform: scale(1.15);
        z-index: 999;
        box-shadow: 0 15px 25px rgba(0,0,0,0.3);
        cursor: grabbing;
        border-color: var(--primary);
    }
